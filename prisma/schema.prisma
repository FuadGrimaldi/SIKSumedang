datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model users {
  id             Int     @id @default(autoincrement())
  kecamatan_id   Int?
  nik            String     @unique @db.VarChar(16)
  username       String     @unique @db.VarChar(50)
  full_name      String     @db.VarChar(255)
  email          String     @unique @db.VarChar(255)
  password       String     @db.VarChar(255)
  role           Role
  status         Status
  last_login_at  DateTime?  
  created_at     DateTime
  updated_at     DateTime

  profile_kecamatan profile_kecamatan? @relation(fields: [kecamatan_id], references: [id])
  articles       articles[]
  agenda_kecamatan agenda_kecamatan[]
}

model profile_kecamatan {
  id               Int       @id @default(autoincrement())
  nama_kecamatan   String
  alamat           String
  telepon          String
  email            String
  website          String?
  foto_kantor      String    @db.VarChar(255)
  visi             String    @db.LongText
  misi             String    @db.LongText
  tujuan           String    @db.LongText
  sejarah          String    @db.LongText
  gmaps_embed_url  String    @db.LongText
  lat              Float?
  lng              Float?
  created_at       DateTime
  updated_at       DateTime

  users            users[]
  komentar         komentar[]  
  pengaduan_aspirasi pengaduan_aspirasi[]
  infografis       infografis[]
  articles         articles[]
  videos           videos[]
  organisasi       organisasi[]
  kategori_organisasi kategori_organisasi[]
  agenda_kecamatan agenda_kecamatan[]
  officials        officials[]
  sarana_prasarana sarana_prasarana[]  
  anggaran_apbkec  anggaran_apbkec[]
}

model infografis {
  id           Int      @id @default(autoincrement())
  kecamatan_id Int  
  title        String   @db.VarChar(255)
  gambar_path  String   @db.VarChar(255)

  profile_kecamatan profile_kecamatan @relation(fields: [kecamatan_id], references: [id])
}

model anggaran_apbkec {
  id                  Int      @id @default(autoincrement())
  kecamatan_id        Int
  tahun_anggaran      Int      @db.Year
  deskripsi           String   @db.LongText
  total_pendapatan    Decimal  @db.Decimal(15, 2)
  total_belanja       Decimal  @db.Decimal(15, 2)
  dokumen_realisasi_path String @db.VarChar(255)
  infografis_path     String   @db.VarChar(255)
  status              ApbdesStatus
  published_at        DateTime

  profile_kecamatan   profile_kecamatan @relation(fields: [kecamatan_id], references: [id])
}

model articles {
  id                 Int    @id @default(autoincrement())
  user_id            Int
  kecamatan_id       Int
  tipe               ArticleType
  title              String    @db.VarChar(255)
  slug               String    @unique
  content            String    @db.LongText
  featured_image     String    @db.VarChar(255)
  dokumen_terkait_path String  @db.VarChar(255)
  waktu_kegiatan     DateTime
  lokasi_kegiatan    String    @db.VarChar(255)
  status             ArticleStatus
  published_at       DateTime
  created_at         DateTime
  updated_at         DateTime

  komentar           komentar[]
  users              users? @relation(fields: [user_id], references: [id])
  profile_kecamatan  profile_kecamatan @relation(fields: [kecamatan_id], references: [id])
}

model videos {
  id           Int      @id @default(autoincrement())
  kecamatan_id Int
  title        String   @db.VarChar(255)
  embed_url    String   @db.VarChar(255)
  kategori     String   
  deskripsi    String   @db.LongText
  uploaded_at  DateTime
  created_at   DateTime
  updated_at   DateTime

  profile_kecamatan profile_kecamatan @relation(fields: [kecamatan_id], references: [id])
}

model organisasi {
  id                  Int    @id @default(autoincrement())
  kecamatan_id        Int
  kategori_id         Int
  nama_organisasi     String @db.VarChar(255)
  nama_ketua          String @db.VarChar(255)
  deskripsi_kegiatan  String @db.LongText
  logo_path           String @db.VarChar(255)

  profile_kecamatan   profile_kecamatan @relation(fields: [kecamatan_id], references: [id])
  kategori_organisasi kategori_organisasi @relation(fields: [kategori_id], references: [id])
}

model kategori_organisasi {
  id              Int          @id @default(autoincrement())
  nama_kategori   String       @db.VarChar(100)
  kecamatan_id    Int

  profile_kecamatan profile_kecamatan @relation(fields: [kecamatan_id], references: [id])
  organisasi      organisasi[]
}

model agenda_kecamatan {
  id           Int     @id @default(autoincrement())
  kecamatan_id Int
  judul        String  @db.VarChar(255)
  slug         String  @unique
  kategori     AgendaKategori
  deskripsi    String  @db.LongText
  lokasi       String  @db.VarChar(255)
  waktu        DateTime
  poster       String  @db.VarChar(255)
  created_by   Int
  status       Status
  created_at   DateTime
  updated_at   DateTime

  profile_kecamatan profile_kecamatan @relation(fields: [kecamatan_id], references: [id])
  users        users  @relation(fields: [created_by], references: [id])
}

model officials {
  id            Int     @id @default(autoincrement())
  kecamatan_id  Int
  name          String
  position      String
  photo         String
  display_order Int
  created_at    DateTime
  updated_at    DateTime

  profile_kecamatan profile_kecamatan @relation(fields: [kecamatan_id], references: [id])
}

model komentar {
  id            Int     @id @default(autoincrement())
  kecamatan_id  Int
  article_id    Int
  name          String  @db.VarChar(255)
  email         String  @db.VarChar(255)
  no_telp       String
  pesan         String  @db.LongText
  status        Status
  created_at    DateTime
  updated_at    DateTime

  profile_kecamatan profile_kecamatan @relation(fields: [kecamatan_id], references: [id])
  articles      articles @relation(fields: [article_id], references: [id])
}

model pengaduan_aspirasi {
  id            Int     @id @default(autoincrement())
  kecamatan_id  Int
  name          String  @db.VarChar(255)
  email         String  @db.VarChar(255)
  no_telp       String
  pesan         String  @db.LongText
  kategori      PengaduanAspirasiKategori
  status        Status
  created_at    DateTime
  updated_at    DateTime

  profile_kecamatan profile_kecamatan @relation(fields: [kecamatan_id], references: [id])
}

model sarana_prasarana {
  id             Int    @id @default(autoincrement())
  kecamatan_id   Int
  kategori       SaranaKategori
  nama_sarana    String @db.VarChar(255)
  deskripsi      String @db.LongText
  alamat_lokasi  String @db.VarChar(255)
  koordinat_lat  String @db.VarChar(50)
  koordinat_long String @db.VarChar(50)
  foto_path      String @db.VarChar(255)
  unggulan       SaranaUnggulan
  status         Status

  profile_kecamatan profile_kecamatan @relation(fields: [kecamatan_id], references: [id])
}

//
// ENUM DEFINITIONS
//

enum PengaduanAspirasiKategori {
  pengaduan
  aspirasi
}

enum Role {
  admin_kecamatan
  masyarakat
  admin_kab
}

enum Status {
  pending
  approved
  rejected
}

enum PotensiKategori {
  Pertanian
  Peternakan
  UMKM
  Pariwisata
  Jasa
}

enum ArticleType {
  berita
  agenda
  sakip
  sid
  kegiatan
  pengumuman
}

enum ArticleStatus {
  published
  draft
}

enum AgendaKategori {
  Kebudayaan
  Olahraga
  Umum
  Peringatan_Hari_Besar
  Sepedahan
  Olahraga_Asik
  PKK
}

enum SaranaKategori {
  pendidikan
  kesehatan
  ibadah
  olahraga
  umum
  wisata
}

enum SaranaUnggulan {
  Y
  N
}

enum ApbdesStatus {
  draft
  published
  archived
}
